================================================================================
NETWORK ANOMALY DETECTION ANALYSIS REPORT
================================================================================
Generated: 2025-11-19 20:57:08

ðŸ“Š SUMMARY
--------------------------------------------------------------------------------
Detection Method: llm_validation
Total Routes Analyzed: 15
âœ… Normal Routes: 13
ðŸš¨ Anomalies Detected: 2

ðŸš¨ DETECTED ANOMALIES
--------------------------------------------------------------------------------

â€¢ PREFIX: 1.0.0.1/32
  TYPE: NET BGP BLACKHOLE ROUTE CONFLICT
  SEVERITY: critical
  REASONING: BGP route is advertised with nexthop 'null' but kernel route has nexthop 'blackhole', indicating a blackhole route conflict.
  ROOT CAUSE: Prefix 1.0.0.1/32: BGP route is advertised (advertised=True, in_bgp=True) but kernel has a static blackhole route (protocol=static, nexthop=blackhole, in_kernel=True). The blackhole route drops all traffic, preventing the valid BGP route from being used.
  REMEDIATION:
    Remove the kernel blackhole route to allow BGP route to be installed.
    NVUE Commands:
    1. Remove blackhole route: nv unset vrf default router static 1.0.0.1/32
    2. Apply configuration: nv config apply
    3. Verify BGP route is installed: nv show vrf default router rib 1.0.0.1/32 ipv4
    4. Check BGP neighbor status: nv show vrf default router bgp neighbor
    5. Test connectivity: ping 1.0.0.1 -c 4
  IMPACT:
    - Network connectivity affected


â€¢ PREFIX: 1.0.0.12/32
  TYPE: NET BGP POLICY VIOLATION
  SEVERITY: critical
  REASONING: Checked policy_action - policy_action == 'deny' â†’ net_bgp_policy_violation anomaly detected.
  ROOT CAUSE: Prefix 1.0.0.12/32: BGP route exists (advertised=True, in_bgp=True) but is blocked by route-map policy 'BLOCK_LEAF12' (action=deny, policy_action=deny). The policy denies route advertisement/installation even though the route exists in BGP.
  REMEDIATION:
    Use clear bgp soft-config to refresh the routes.
    NVUE Commands:
    1. Show BGP route with policy: nv show vrf default router bgp address-family ipv4-unicast route 1.0.0.12/32
    2. Check route-map configuration: nv show router policy route-map BLOCK_LEAF12
    3. Clear BGP session (soft): nv action clear vrf default router bgp address-family ipv4-unicast soft
    4. Modify policy if needed: nv set router policy route-map BLOCK_LEAF12 rule <rule-id> action permit
    5. Apply configuration: nv config apply
    6. Verify route is installed: nv show vrf default router rib 1.0.0.12/32 ipv4
  IMPACT:
    - Network connectivity affected
    - Routing loop potential


ðŸ“Š CORRELATION DATA (LLM-Driven)
--------------------------------------------------------------------------------
Correlated Routes: 15
Correlated Interfaces: 0
Correlated Neighbors: 0
Correlation Method: llm_driven

================================================================================
END OF REPORT
================================================================================